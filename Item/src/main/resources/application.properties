spring.application.name=item-service
server.port=8081

# Eureka Configuration (Vital)
eureka.client.service-url.defaultZone=http://eureka-server:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true

# Logical URL for WebClient
product.service.url=http://product-service/api/v1/products

# --- RETRY CONFIGURATION ---
# Maximum number of attempts (including the first one)
resilience4j.retry.instances.products.max-attempts=3
# Wait 1 second between retry attempts
resilience4j.retry.instances.products.wait-duration=1s
# Specific exceptions that should trigger a retry
resilience4j.retry.instances.products.retry-exceptions=java.util.concurrent.TimeoutException,java.io.IOException

# --- RESILIENCE4J CONFIGURATION ---

# Circuit Breaker Configuration
# How many calls to monitor before calculating the error rate
resilience4j.circuitbreaker.instances.products.sliding-window-size=10
# If 50% of calls fail, the circuit opens
resilience4j.circuitbreaker.instances.products.failure-rate-threshold=50
# Time to wait before trying to call the service again (half-open state)
resilience4j.circuitbreaker.instances.products.wait-duration-in-open-state=10s
# Number of successful calls needed to close the circuit again
resilience4j.circuitbreaker.instances.products.permitted-number-of-calls-in-half-open-state=3
# Essential for WebFlux/Reactive consistency
resilience4j.circuitbreaker.configs.default.register-health-indicator=true

# Time Limiter Configuration (Timeout)
# If the product service takes more than 2 seconds, it counts as a failure
resilience4j.timelimiter.instances.products.timeout-duration=2s